on:
  push:
    branches:
      - main
name: ðŸš€ Deploy website on push
jobs:
  web-deploy:
    name: ðŸŽ‰ Deploy
    runs-on: ubuntu-latest
    steps:
      - name: ðŸšš Get latest code
        uses: actions/checkout@v3

      - name: ðŸ›  Build Angular app
        run: |
          npm install -g @angular/cli
          npm install
          ng build

      - name: ðŸ§ª Run unit tests
        run: |
          ng test --watch=false --browsers=ChromeHeadless --code-coverage
          # Replace 'ChromeHeadless' with the browser you want to use for testing.

      - name: ðŸ“‚ Sync files
        uses: SamKirkland/FTP-Deploy-Action@v4.3.4
        with:
          server: ftp.cluster000.hosting.toto.net
          username: rondoudou
          password: ${{ secrets.test }}
          local-dir: dist/rien/ # This is the local directory to upload
          server-dir: /vide/ # This is the remote directory on the server
